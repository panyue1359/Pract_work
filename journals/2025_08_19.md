## multiRegionPhaseChangeFlow模拟充型过程
collapsed:: true
	- ((68274234-f87f-4ce0-865f-2164130b5fd0))
	  collapsed:: true
		- collapsed:: true
		  >参考
			- ((68a29d28-1c59-4a39-8400-23a898f1bbfa))
- multiRegionPhaseChangeFlow是两相可压缩流多区域共轭传热求解器，需要注意的是thermophysicalProperties中thermo和energy的组合是hConst和sensibleInternalEnergy，而非hConst和sensibleEnthalpy。
- #+BEGIN_PINNED
  计算发散
  #+END_PINNED
- 当前版本(2406)的表面张力和相变模块的耦合似乎存在问题，两者不能同时开启。考虑到充型过程中熔融金属不会发生气液相变，所以不启用相变模块。具体做法是：将phaseChangeProperties中的massSourceTermModel设置为`noPhaseChange`，marcoModels设置为空。
	- 启用相变时fvSolution的reconstructionScheme只有isoSurface可用，其他格式均在一段时间后发散
- 流体的状态方程对收敛性影响很大，配置文件为constant下的thermophysicalProperties.xxx，其中equationOfState设置为incompressiblePerfectGas立刻发散（无论是否启用相变），perfectGas较快发散，perfectFluid缓慢发散，**rhoConst可稳定计算**
- fvSolution的advectionScheme**使用MULESScheme时容易崩溃**，isoAdvection和geoAdvection差别不大
- #+BEGIN_PINNED
  自由表面的形状
  #+END_PINNED
- constant下的thermophysicalProperties，其中surfaceTensionForceModel的 Height Function Method 只适合结构化网格，RDF gradAlpha fitParaboloid 差别不大
- fvSolution的reconstructionScheme使用isoSurface时两相界面不太正常，使用其他重构格式差别不大
- **设置momentumPredictor为true**会减慢计算速度，但自由表面的形状更加对称
- #+BEGIN_PINNED
  温度分布异常
  #+END_PINNED
- 温度场不连续，呈“高温-低温”交错分布。观察温度残差，发现残差远超过1，但计算没有崩溃
- fvSchemes中div(rhoPhi,T)  Gauss upwind; div(rhoCpLPhi,T.Al) Gauss linear; div(rhoCpVPhi,T.Air) Gauss linear; 三项的离散格式设置为linear时容易发散，**设置为upwind则不发散** [Inconsistencies in unstructured geometric volume-of-fluid methods for two-phase flows with high density ratios - ScienceDirect](https://www.sciencedirect.com/science/article/pii/S004579302400207X?via%3Dihub#sec4)
- nCorrectors影响很大，**取2时较不容易发散**，其他值都容易发散
- #+BEGIN_PINNED
  自由表面温度异常
  #+END_PINNED
- 自由表面处的温度迅速降低、升高或者不变
- 设置`massSourceTermModel`为`noPhaseChange`只能保证气液两相间没有物质传输，但能量传输仍在发生
- `phaseChangeProperties`文件下`singleComponentSatProp`定义了饱和蒸汽压曲线，一种定义方式是施拉格模型外推，另一种是自定义饱和蒸汽压曲线。当液相的温度和压力不在饱和蒸汽压曲线上时就会发生相变 [施拉格沸腾/冷凝模型参考](https://starccm.jachwang.co.uk/GUID-8331D0E1-AB17-42BD-B0EB-BD14B2401FA1.html)
- 将这部分按如下设置，将使得气液两相始终处于相平衡状态，即不发生相变，温度范围为室温和浇注温度，饱和蒸汽压在此区间内始终是1e5
  ``` c++
  satProperties
  {
      singleComponentSatProp function;
      Tmin 300;
      Tmax 1000;
      pSat table
          (
              (300 1e5)
              (1000 1e5)      
          );
      TSat constant 1000;
      L constant 1;
  }
  ```