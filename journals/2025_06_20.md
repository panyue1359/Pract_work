## MicroSim
id:: 6855245f-b049-4a86-8ad0-2dd1539eefb5
collapsed:: true
	- ((64465741-07d5-4238-a48f-8dbc8cba938d))
	  collapsed:: true
		- collapsed:: true
		  >参考
			- ((68479c8f-62ed-461d-b0c1-6f77eaa20f9a))
			- ((684e3572-05cf-465a-a998-ec2c7b09f9b3))
			- ((684e5a7f-0479-4697-aabc-e7d3457b81bb))
- MicroSim 是印度政府主导的National Supercomputing Mission项目中的一部分，基于Linux系统，包含若干个用于模拟微观组织演化的相场模型，可通过用户界面(GUI)脚本可调用这些模型。最新版本为 4.0 [MicroSim | Microstructure Simulator](https://microsim.co.in/)，教程在YouTube上 [MicroSim - YouTube](https://www.youtube.com/@microsim)
- ## 创建 MicroSim GUI Docker镜像
  id:: 6855245f-ab09-4f9d-b3c2-266dd90f9bab
  collapsed:: true
	- ((6855245f-b049-4a86-8ad0-2dd1539eefb5))
	  collapsed:: true
		- collapsed:: true
		  >参考
			- ((69493361-687e-4c02-8602-804874da19b3))
- 安装并运行VcXsrv，问题解决详见“在Docker中使用图形界面程序”条目；
  logseq.order-list-type:: number
- 官网下载MicroSim 4.0源码包，下载Miniconda3-py310_23.1.0-1-Linux-x86_64.sh脚本；
  logseq.order-list-type:: number
- 执行`docker pull ubuntu:22.04`拉取Ubuntu镜像，执行`docker container run --name=microsim -ti --rm -e DISPLAY=host.docker.internal:0.0 -v D:/Download/MicroSim-4.0:/MicroSim -w /MicroSim ubuntu:20.04` 创建容器，注意修改-v和-w的参数为自己的路径；
  logseq.order-list-type:: number
- 据MicroSim手册“MicroSim_Installation_GUI_Infile_generator_post-processing_tool.pdf”，在容器中安装Miniconda、创建虚拟环境msenv并下载python依赖包（`pip install pyqt5 scikit-image vtk tinydb sympy==1.8 pycalphad==0.9.2 pymks yt dask[dataframe] numpy==1.24.0`，使用国内源下载）；
  logseq.order-list-type:: number
	- numpy使用1.24.0的原因见“MicroSim GUI run按钮报错”条目
	  logseq.order-list-type:: number
- 执行`apt update`和`apt install -y libgl1-mesa-glx libglib2.0-0 libxrender1 libxcb-xinerama0 qt6-qpa-plugins libgsl-dev`以补全可视化依赖包（有可能找不到qp6-qpa-plugins，原因不明）[solved: Could not load the Qt platform plugin "xcb" · NVlabs/instant-ngp · Discussion #300](https://github.com/NVlabs/instant-ngp/discussions/300)；
  logseq.order-list-type:: number
- 执行`apt install -y build-essential gcc openmpi-bin openmpi-doc libopenmpi-dev dbus-x11 dbus`安装openmpi及其依赖
  logseq.order-list-type:: number
- 执行`apt install -y gnome-terminal`安装gnome终端，安装后MicroSim GUI中的`run`按钮才可用
  logseq.order-list-type:: number
- #+BEGIN_WARNING
  注意事项
  #+END_WARNING
- 上述步骤创建的容器仅能用于创建Input.in和Filling.in文件，`run`按钮不可用
- 若要使用`run`按钮自动编译求解器和执行计算，参考“MicroSim GUI run按钮报错”条目进行后续配置
- 运行时若提示“libGL error: MESA-LOADER: failed to open swrast”，可执行`export LD_PRELOAD=/usr/lib/x86_64-linux-gnu/libstdc++.so.6` [smplx 的 libGL error: MESA-LOADER: failed to open swrast 的解决方法 - TonyYPZhang - 博客园](https://www.cnblogs.com/TonyYPZhang/p/18055685)
- #+BEGIN_NOTE
  在Linux系统中使用MicroSim
  #+END_NOTE
- 执行上述步骤3、5、6和7即可，其中步骤6去掉“qp6-qpa-plugins”包
  logseq.order-list-type:: number